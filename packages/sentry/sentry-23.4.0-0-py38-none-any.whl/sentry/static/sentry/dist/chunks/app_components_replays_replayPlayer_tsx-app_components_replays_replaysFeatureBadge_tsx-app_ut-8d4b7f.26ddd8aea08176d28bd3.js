"use strict";(globalThis.webpackChunk=globalThis.webpackChunk||[]).push([["app_components_replays_replayPlayer_tsx-app_components_replays_replaysFeatureBadge_tsx-app_ut-8d4b7f"],{"./app/components/replays/replayPlayer.tsx":(e,t,r)=>{r.d(t,{Z:()=>P});var s=r("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),a=r("../node_modules/react/index.js"),i=r("../node_modules/@react-aria/utils/dist/module.js"),n=r("./app/components/loadingIndicator.tsx"),o=r("./app/icons/index.tsx"),l=r("./app/locale.tsx"),c=r("./app/styles/space.tsx"),d=r("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");function p(e){let{className:t}=e;return(0,d.tZ)(u,{className:t,children:(0,d.BX)(m,{children:[(0,d.tZ)(o.jo,{size:"sm"}),(0,l.t)("Buffering...")]})})}p.displayName="BufferingOverlay";const u=(0,s.Z)("div",{target:"e1339gql1"})({name:"1p9eycc",styles:"user-select:none;display:grid;place-items:center"}),m=(0,s.Z)("div",{target:"e1339gql0"})("display:grid;grid-template-columns:max-content max-content;gap:",(0,c.D)(.75),";place-items:center;padding:",(0,c.D)(3),";background:",(e=>e.theme.gray300),";border-radius:",(e=>e.theme.borderRadius),";color:",(e=>e.theme.white),";z-index:",(e=>e.theme.zIndex.initial),";"),h=p;var g=r("./app/components/tooltip.tsx");function y(e){let{speed:t,className:r}=e;return(0,d.tZ)(f,{className:r,children:(0,d.BX)(b,{title:(0,l.t)("Fast forwarding at %sx",t),children:[(0,l.t)("Fast forwarding through inactivity"),(0,d.tZ)(o.CC,{size:"sm",direction:"right"})]})})}y.displayName="FastForwardBadge";const f=(0,s.Z)("div",{target:"e1a5fqdb1"})({name:"8y7axy",styles:"user-select:none;display:grid;align-items:end;justify-items:start"}),b=(0,s.Z)(g.u,{target:"e1a5fqdb0"})("display:grid;grid-template-columns:max-content max-content;gap:",(0,c.D)(.5),";align-items:center;background:",(e=>e.theme.gray300),";color:",(e=>e.theme.white),";padding:",(0,c.D)(1.5)," ",(0,c.D)(2),";border-top-right-radius:",(e=>e.theme.borderRadius),";z-index:",(e=>e.theme.zIndex.initial),";"),x=y;var w=r("./app/components/replays/replayContext.tsx"),Z=r("./app/utils/analytics/trackAdvancedAnalyticsEvent.tsx"),k=r("./app/utils/useOrganization.tsx"),v=r("./app/components/button.tsx"),S=r("./app/utils/useLocalStorageState.ts");function D(){const{dismiss:e,isDismissed:t}=function(e){let{expirationDays:t=Number.MAX_SAFE_INTEGER,key:r}=e;const[s,i]=(0,S.R)(r,(e=>e?String(e):void 0));return{isDismissed:t===Number.MAX_SAFE_INTEGER?Boolean(s):function(e,t){return!(!e||isNaN(e))&&(Date.now()-e)/864e5<t}(Number(s),t),dismiss:(0,a.useCallback)((()=>{i(Date.now().toString())}),[i])}}({key:"replay-player-dom-alert-dismissed"});return t?null:(0,d.tZ)(E,{"data-test-id":"player-dom-alert",children:(0,d.BX)(N,{children:[(0,d.tZ)(j,{size:"xs"}),(0,d.tZ)("div",{children:(0,l.t)("Right click & inspect your appâ€™s DOM with your browser")}),(0,d.tZ)(_,{priority:"link",size:"sm",icon:(0,d.tZ)(o.bM,{size:"xs"}),"aria-label":(0,l.t)("Close Alert"),onClick:e})]})})}D.displayName="PlayerDOMAlert";const M=D,E=(0,s.Z)("div",{target:"e138qk33"})("position:absolute;bottom:",(0,c.D)(1),";left:0;width:100%;text-align:center;font-size:",(e=>e.theme.fontSizeMedium),";pointer-events:none;"),N=(0,s.Z)("div",{target:"e138qk32"})("display:inline-flex;align-items:flex-start;justify-items:center;padding:",(0,c.D)(1)," ",(0,c.D)(2),";margin:0 ",(0,c.D)(1),";color:",(e=>e.theme.white),";background-color:",(e=>e.theme.blue400),";border-radius:",(e=>e.theme.borderRadius),";gap:0 ",(0,c.D)(1),";line-height:1em;"),j=(0,s.Z)(o.aU,{target:"e138qk31"})({name:"n27fom",styles:"margin-top:1px;min-width:12px"}),_=(0,s.Z)(v.zx,{target:"e138qk30"})("color:",(e=>e.theme.white),";pointer-events:all;&:hover{color:",(e=>e.theme.white),";opacity:0.5;}");function I(e){let{className:t,isPreview:r=!1}=e;const{dimensions:s,fastForwardSpeed:n,initRoot:o,isBuffering:l,isFetching:c}=(0,w.M)(),p=(0,a.useRef)(null),u=(0,a.useRef)(null),[m,h]=(0,a.useState)({width:0,height:0});!function(e){let{videoDimensions:t,windowDimensions:r}=e;const s=(0,k.Z)(),[i,n]=(0,a.useState)(!1);(0,a.useEffect)((()=>{if(i||0===t.width&&0===t.height)return;const e=t.width>t.height?"landscape":"portrait",a=Math.min(r.width/t.width,r.height/t.height,1),o=10*Math.floor(10*a);(0,Z.Z)("replay.render-player",{organization:s,aspect_ratio:e,scale_bucket:o}),n(!0)}),[s,r,t,i])}({videoDimensions:s,windowDimensions:m}),(0,a.useEffect)((()=>o(u.current)),[o]);const g=(0,a.useCallback)((()=>h({width:p.current?.clientWidth||0,height:p.current?.clientHeight||0})),[h]);return(0,i.yU)({ref:p,onResize:g}),(0,a.useEffect)((()=>{void 0===window.ResizeObserver&&g()}),[g]),(0,a.useEffect)((()=>{if(u.current){const e=Math.min(m.width/s.width,m.height/s.height,1);e&&(u.current.style["transform-origin"]="top left",u.current.style.transform=`scale(${e})`,u.current.style.width=s.width*e+"px",u.current.style.height=s.height*e+"px")}}),[m,s]),(0,d.BX)(R,{ref:p,className:"sentry-block",children:[(0,d.tZ)("div",{ref:u,className:t}),n?(0,d.tZ)(C,{speed:n}):null,l?(0,d.tZ)(z,{}):null,r?null:(0,d.tZ)(M,{}),c?(0,d.tZ)(T,{}):null]})}I.displayName="BasePlayerRoot";const R=(0,s.Z)("div",{target:"egqkti35"})("width:100%;display:flex;flex-grow:1;justify-content:center;align-items:center;position:relative;overflow:hidden;background-color:",(e=>e.theme.backgroundSecondary),";background-image:repeating-linear-gradient(\n      -145deg,\n      transparent,\n      transparent 8px,\n      ",(e=>e.theme.backgroundSecondary)," 8px,\n      ",(e=>e.theme.backgroundSecondary)," 11px\n    ),repeating-linear-gradient(\n      -45deg,\n      transparent,\n      transparent 15px,\n      ",(e=>e.theme.gray100)," 15px,\n      ",(e=>e.theme.gray100)," 16px\n    );"),C=(0,s.Z)(x,{target:"egqkti34"})({name:"m4y3yb",styles:"position:absolute;left:0;bottom:0"}),z=(0,s.Z)(h,{target:"egqkti33"})({name:"j2pfbl",styles:"position:absolute;top:0;left:0;right:0;bottom:0"}),T=(0,s.Z)(n.Z,{target:"egqkti32"})({name:"a4hmbt",styles:"position:absolute"}),A=(0,s.Z)(I,{target:"egqkti31"})({name:"1ak6w60",styles:".replayer-wrapper{user-select:none;}.replayer-wrapper>.replayer-mouse{pointer-events:none;}.replayer-wrapper>.replayer-mouse-tail{position:absolute;pointer-events:none;}.replayer-wrapper>iframe{border:none;background:white;pointer-events:initial!important;}"}),P=(0,s.Z)(A,{target:"egqkti30"})(".replayer-mouse{position:absolute;width:32px;height:32px;transition:left 0.05s linear,top 0.05s linear;background-size:contain;background-repeat:no-repeat;background-image:url('data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTIiIGhlaWdodD0iMTkiIHZpZXdCb3g9IjAgMCAxMiAxOSIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHBhdGggZD0iTTAgMTZWMEwxMS42IDExLjZINC44TDQuNCAxMS43TDAgMTZaIiBmaWxsPSJ3aGl0ZSIvPgo8cGF0aCBkPSJNOS4xIDE2LjdMNS41IDE4LjJMMC43OTk5OTkgNy4xTDQuNSA1LjZMOS4xIDE2LjdaIiBmaWxsPSJ3aGl0ZSIvPgo8cGF0aCBkPSJNNC42NzQ1MSA4LjYxODUxTDIuODMwMzEgOS4zOTI3MUw1LjkyNzExIDE2Ljc2OTVMNy43NzEzMSAxNS45OTUzTDQuNjc0NTEgOC42MTg1MVoiIGZpbGw9ImJsYWNrIi8+CjxwYXRoIGQ9Ik0xIDIuNFYxMy42TDQgMTAuN0w0LjQgMTAuNkg5LjJMMSAyLjRaIiBmaWxsPSJibGFjayIvPgo8L3N2Zz4K');border-color:transparent;}.replayer-mouse:after{content:'';display:inline-block;width:32px;height:32px;background:",(e=>e.theme.purple300),";border-radius:100%;transform:translate(-50%, -50%);opacity:0.3;}.replayer-mouse.active:after{animation:click 0.2s ease-in-out 1;}.replayer-mouse.touch-device{background-image:none;width:70px;height:70px;border-radius:100%;margin-left:-37px;margin-top:-37px;border:4px solid rgba(73, 80, 246, 0);transition:left 0s linear,top 0s linear,border-color 0.2s ease-in-out;}.replayer-mouse.touch-device.touch-active{border-color:",(e=>e.theme.purple200),";transition:left 0.25s linear,top 0.25s linear,border-color 0.2s ease-in-out;}.replayer-mouse.touch-device:after{opacity:0;}.replayer-mouse.touch-device.active:after{animation:touch-click 0.2s ease-in-out 1;}@keyframes click{0%{opacity:0.3;width:20px;height:20px;}50%{opacity:0.5;width:10px;height:10px;}}@keyframes touch-click{0%{opacity:0;width:20px;height:20px;}50%{opacity:0.5;width:10px;height:10px;}}")},"./app/components/replays/replaysFeatureBadge.tsx":(e,t,r)=>{r.d(t,{Z:()=>n});var s=r("./app/components/featureBadge.tsx"),a=r("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");function i(e){return(0,a.tZ)(s.Z,{...e,type:"new"})}i.displayName="ReplaysFeatureBadge";const n=i},"./app/utils/replays/hooks/useReplayData.tsx":(e,t,r)=>{r.d(t,{Z:()=>m});var s=r("../node_modules/react/index.js"),a=r("../node_modules/@sentry/core/esm/exports.js"),i=r("../node_modules/lodash/chunk.js"),n=r.n(i),o=r("./app/utils/replays/replayDataUtils.tsx"),l=r("../node_modules/@babel/runtime/helpers/esm/defineProperty.js"),c=r("../node_modules/moment/moment.js");class d{static factory(e){let{attachments:t,replayRecord:r,errors:s}=e;return t&&r&&s?new d({attachments:t,replayRecord:r,errors:s}):null}constructor(e){let{attachments:t,replayRecord:r,errors:s}=e;(0,l.Z)(this,"replayRecord",void 0),(0,l.Z)(this,"rrwebEvents",void 0),(0,l.Z)(this,"breadcrumbs",void 0),(0,l.Z)(this,"consoleCrumbs",void 0),(0,l.Z)(this,"networkSpans",void 0),(0,l.Z)(this,"memorySpans",void 0),(0,l.Z)(this,"getDurationMs",(()=>this.replayRecord.duration.asMilliseconds())),(0,l.Z)(this,"getReplay",(()=>this.replayRecord)),(0,l.Z)(this,"getRRWebEvents",(()=>this.rrwebEvents)),(0,l.Z)(this,"getRawCrumbs",(()=>this.breadcrumbs)),(0,l.Z)(this,"getConsoleCrumbs",(()=>this.consoleCrumbs)),(0,l.Z)(this,"getNetworkSpans",(()=>this.networkSpans)),(0,l.Z)(this,"getMemorySpans",(()=>this.memorySpans));const{breadcrumbs:a,rrwebEvents:i,spans:n}=(0,o.Hs)(t),{startTimestampMs:d,endTimestampMs:p}=(0,o.iz)(r,i,a,n);r.started_at=new Date(d),r.finished_at=new Date(p),r.duration=(0,c.duration)(r.finished_at.getTime()-r.started_at.getTime());const u=(0,o._O)(n);this.networkSpans=u.filter(o.j1),this.memorySpans=u.filter(o.qI),this.breadcrumbs=(0,o.so)(r,s,a,u),this.consoleCrumbs=(0,o.c_)(this.breadcrumbs,["console","issue"]),this.rrwebEvents=(0,o.ay)(r,i),this.replayRecord=r}}var p=r("./app/utils/useApi.tsx");const u=Object.freeze({fetchError:void 0,fetchingAttachments:!0,fetchingErrors:!0,fetchingReplay:!0}),m=function(e){let{replaySlug:t,orgSlug:r,errorsPerPage:i=50,segmentsPerPage:l=100}=e;const[c,m]=t.split(":"),h=(0,p.Z)(),[g,y]=(0,s.useState)(u),[f,b]=(0,s.useState)([]),[x,w]=(0,s.useState)([]),[Z,k]=(0,s.useState)(),v=(0,s.useCallback)((async()=>{const e=await h.requestPromise(`/projects/${r}/${c}/replays/${m}/`),t=(0,o.qC)(e.data);k(t),y((e=>({...e,fetchingReplay:!1})))}),[h,r,c,m]),S=(0,s.useCallback)((async()=>{if(!Z)return;if(!Z.count_segments)return void y((e=>({...e,fetchingAttachments:!1})));const e=Math.ceil(Z.count_segments/l),t=new Array(e).fill(0).map(((e,t)=>`${l}:${t}:${0===t?1:0}`));await Promise.allSettled(t.map((e=>{const t=h.requestPromise(`/projects/${r}/${c}/replays/${Z.id}/recording-segments/`,{query:{download:!0,per_page:l,cursor:e}});return t.then((e=>{b((t=>(t??[]).concat(...e)))})),t}))),y((e=>({...e,fetchingAttachments:!1})))}),[l,h,r,c,Z]),D=(0,s.useCallback)((async()=>{if(!Z)return;if(!Z.error_ids.length)return void y((e=>({...e,fetchingErrors:!1})));const e=new Date(Z.finished_at);e.setSeconds(e.getSeconds()+1);const t=n()(Z.error_ids,i);await Promise.allSettled(t.map((t=>{const s=h.requestPromise(`/organizations/${r}/replays-events-meta/`,{query:{start:Z.started_at.toISOString(),end:e.toISOString(),query:`id:[${String(t)}]`}});return s.then((e=>{w((t=>(t??[]).concat(e.data||[])))})),s}))),y((e=>({...e,fetchingErrors:!1})))}),[i,h,r,Z]),M=(0,s.useCallback)((e=>{a.Tb(e),y((t=>({...t,fetchError:e})))}),[]),E=(0,s.useCallback)((()=>v().catch(M)),[v,M]);(0,s.useEffect)((()=>{E()}),[E]),(0,s.useEffect)((()=>{g.fetchError||D().catch(M)}),[g.fetchError,D,M]),(0,s.useEffect)((()=>{g.fetchError||S().catch(M)}),[g.fetchError,S,M]);const N=(0,s.useMemo)((()=>d.factory({attachments:f,errors:x,replayRecord:Z})),[f,x,Z]);return{fetchError:g.fetchError,fetching:g.fetchingAttachments||g.fetchingErrors||g.fetchingReplay,onRetry:E,replay:N,replayRecord:Z}}},"./app/views/replays/detail/layout/fluidHeight.tsx":(e,t,r)=>{r.d(t,{Z:()=>s});const s=(0,r("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js").Z)("div",{target:"eu9w9ak0"})({name:"1i32vcf",styles:"display:flex;flex-direction:column;flex-wrap:nowrap;flex-grow:1;overflow:hidden;height:100%"})}}]);
//# sourceMappingURL=../sourcemaps/app_components_replays_replayPlayer_tsx-app_components_replays_replaysFeatureBadge_tsx-app_ut-8d4b7f.1adb106dcd8092541be1b6f8253ace01.js.map