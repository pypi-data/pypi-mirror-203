"use strict";(globalThis.webpackChunk=globalThis.webpackChunk||[]).push([["app_views_settings_organizationTeams_teamMembers_tsx"],{"./app/components/roleSelectControl.tsx":(e,t,s)=>{s.d(t,{Z:()=>n});var r=s("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),a=s("./app/components/forms/controls/selectControl.tsx"),o=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");function i(e){let{roles:t,disableUnallowed:s,...r}=e;return(0,o.tZ)(a.Z,{options:t?.map((e=>({value:e.id,label:e.name,disabled:s&&!e.allowed||e.isRetired,details:(0,o.tZ)(m,{children:e.desc})}))),showDividers:!0,...r})}i.displayName="RoleSelectControl";const n=i,m=(0,r.Z)("span",{target:"eu9y8de0"})({name:"vad6xm",styles:"display:inline-block;width:20rem"})},"./app/utils/orgRole.tsx":(e,t,s)=>{function r(e,t){const s=t.reduce(((e,t,s)=>(e[t.id]={index:s,role:t},e)),{});return e.sort(((e,t)=>s[t].index-s[e].index)),s[e[0]]?.role}s.d(t,{M:()=>r})},"./app/views/asyncView.tsx":(e,t,s)=>{s.d(t,{Z:()=>i});var r=s("./app/components/asyncComponent.tsx"),a=s("./app/components/sentryDocumentTitle.tsx"),o=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");class i extends r.Z{getTitle(){return""}render(){return(0,o.tZ)(a.Z,{title:this.getTitle(),children:this.renderComponent()})}}i.displayName="AsyncView"},"./app/views/settings/organizationTeams/roleOverwriteWarning.tsx":(e,t,s)=>{s.d(t,{Sk:()=>m,d8:()=>d,pu:()=>l});var r=s("./app/components/panels/index.tsx"),a=s("./app/components/tooltip.tsx"),o=s("./app/icons/index.tsx"),i=s("./app/locale.tsx"),n=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");function m(e){return d(e)?(0,n.tZ)(a.u,{title:p(e),children:(0,n.tZ)(o.aU,{size:"sm",color:"gray300"})}):null}function l(e){return d(e)?(0,n.tZ)(r.aU,{"data-test-id":"alert-role-overwrite",children:p(e)}):null}function d(e){const{orgRole:t,orgRoleList:s,teamRoleList:r}=e,a=s.find((e=>e.id===t));return r.findIndex((e=>e.id===a?.minimumTeamRole))>0}function p(e){const{orgRole:t,orgRoleList:s,teamRoleList:r,isSelf:a}=e,o=s.find((e=>e.id===t)),m=r.find((e=>e.id===o?.minimumTeamRole));return o&&m?(0,i._N)("[selfNoun] organization role as [article] [orgRole] has granted [selfPronoun] a minimum team-level role of [teamRole]",{selfNoun:a?"Your":"This user's",selfPronoun:a?"you":"them",article:"AEIOU".includes(o.name[0])?"an":"a",orgRole:(0,n.tZ)("strong",{children:o.name}),teamRole:(0,n.tZ)("strong",{children:m.name})}):""}m.displayName="RoleOverwriteIcon",l.displayName="RoleOverwritePanelAlert"},"./app/views/settings/organizationTeams/teamMembers.tsx":(e,t,s)=>{s.r(t),s.d(t,{default:()=>J});var r=s("../node_modules/@babel/runtime/helpers/esm/defineProperty.js"),a=s("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),o=(s("../node_modules/core-js/modules/es.regexp.flags.js"),s("../node_modules/react/index.js")),i=s("../node_modules/lodash/debounce.js"),n=s.n(i),m=s("./app/actionCreators/indicator.tsx"),l=s("./app/actionCreators/modal.tsx"),d=s("./app/actionCreators/teams.tsx"),p=s("./app/components/avatar/userAvatar.tsx"),c=s("./app/components/dropdownAutoComplete/index.tsx"),u=s("./app/components/dropdownButton.tsx"),g=s("./app/components/emptyMessage.tsx"),h=s("./app/components/links/link.tsx"),b=s("./app/components/loadingError.tsx"),x=s("./app/components/loadingIndicator.tsx"),Z=s("./app/components/pagination.tsx"),f=s("./app/components/panels/index.tsx"),v=s("./app/icons/index.tsx"),w=s("./app/locale.tsx"),R=s("./app/styles/space.tsx"),y=s("./app/utils/withApi.tsx"),M=s("./app/utils/withConfig.tsx"),z=s("./app/utils/withOrganization.tsx"),T=s("./app/views/asyncView.tsx"),S=(s("../node_modules/core-js/modules/es.array.push.js"),s("./app/components/button.tsx")),I=s("./app/components/idBadge/index.tsx"),C=s("./app/components/roleSelectControl.tsx"),j=s("./app/utils/orgRole.tsx"),O=s("./app/views/settings/organizationTeams/roleOverwriteWarning.tsx"),k=s("./app/views/settings/organizationTeams/utils.tsx"),_=s("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");function q(e){const{organization:t,team:s,member:r,user:a,hasWriteAccess:o,isOrgOwner:i,removeMember:n,updateMemberRole:m}=e;return(0,_.BX)(F,{children:[(0,_.tZ)("div",{children:(0,_.tZ)(I.Z,{avatarSize:36,member:r,useLink:!0,orgId:t.slug})}),(0,_.tZ)("div",{children:(0,_.tZ)(B,{hasWriteAccess:o,updateMemberRole:m,organization:t,team:s,member:r})}),(0,_.tZ)("div",{children:(0,_.tZ)(A,{hasWriteAccess:o,hasOrgRoleFromTeam:null!==s.orgRole,isOrgOwner:i,onClick:()=>n(r),member:r,user:a})})]},r.id)}function B(e){const{hasWriteAccess:t,organization:s,team:r,member:a,updateMemberRole:o}=e,{orgRoleList:i,teamRoleList:n,features:m}=s;if(!m.includes("team-roles"))return null;const l=[a.orgRole];a.orgRolesFromTeams&&a.orgRolesFromTeams.length>0&&l.push(a.orgRolesFromTeams[0].role.id),r.orgRole&&l.push(r.orgRole);const d=(0,j.M)(l,i),p=a.teamRole||d?.minimumTeamRole,c=n.find((e=>e.id===p))||n[0];return!t||(0,O.d8)({orgRole:d?.id,orgRoleList:i,teamRoleList:n})?(0,_.BX)(L,{children:[c.name,(0,_.tZ)(D,{children:(0,_.tZ)(O.Sk,{orgRole:d?.id,orgRoleList:i,teamRoleList:n})})]}):(0,_.tZ)(N,{children:(0,_.tZ)(C.Z,{roles:n,value:c.id,onChange:e=>o(a,e.value),disableUnallowed:!0})})}function A(e){const{member:t,user:s,hasWriteAccess:r,isOrgOwner:a,hasOrgRoleFromTeam:o,onClick:i}=e,n=t.email===s.email,m=r||n;if(!m)return null;const l=t.flags["idp:provisioned"],d=o&&!a,p=(0,k.m)(l,d);return l||d?(0,_.tZ)(S.zx,{size:"xs",disabled:!0,icon:(0,_.tZ)(v.JZ,{size:"xs",isCircled:!0}),onClick:i,"aria-label":(0,w.t)("Remove"),title:p,children:(0,w.t)("Remove")}):(0,_.tZ)(S.zx,{size:"xs",disabled:!m,icon:(0,_.tZ)(v.JZ,{size:"xs",isCircled:!0}),onClick:i,"aria-label":(0,w.t)("Remove"),children:(0,w.t)("Remove")})}q.displayName="TeamMembersRow",B.displayName="TeamRoleSelect",A.displayName="RemoveButton";const L=(0,a.Z)("div",{target:"eqg848x3"})({name:"s5xdrg",styles:"display:flex;align-items:center"}),D=(0,a.Z)("div",{target:"eqg848x2"})("height:",(0,R.D)(2),";margin-left:",(0,R.D)(1),";"),N=(0,a.Z)("div",{target:"eqg848x1"})({name:"5b6t4c",styles:"display:flex;flex-direction:row;align-items:center;>div:first-child{flex-grow:1;}"}),F=(0,a.Z)(f.Lv,{target:"eqg848x0"})("display:grid;grid-template-columns:minmax(120px, 4fr) minmax(120px, 2fr) minmax(100px, 1fr);gap:",(0,R.D)(2),";align-items:center;>div:last-child{margin-left:auto;}"),U=q;class W extends T.Z{constructor(){super(...arguments),(0,r.Z)(this,"debouncedFetchMembersRequest",n()((e=>this.setState({dropdownBusy:!0},(()=>this.fetchMembersRequest(e)))),200)),(0,r.Z)(this,"fetchMembersRequest",(async e=>{const{organization:t,api:s}=this.props;try{const r=await s.requestPromise(`/organizations/${t.slug}/members/`,{query:{query:e}});this.setState({orgMembers:r,dropdownBusy:!1})}catch(e){(0,m.Iw)((0,w.t)("Unable to load organization members."),{duration:2e3}),this.setState({dropdownBusy:!1})}})),(0,r.Z)(this,"addTeamMember",(e=>{const{organization:t,params:s}=this.props,{orgMembers:r,teamMembers:a}=this.state;this.setState({loading:!0}),this.debouncedFetchMembersRequest(""),(0,d.um)(this.props.api,{orgId:t.slug,teamId:s.teamId,memberId:e.value},{success:()=>{const t=r.find((t=>t.id===e.value));void 0!==t&&(this.setState({loading:!1,error:!1,teamMembers:a.concat([t])}),(0,m.S9)((0,w.t)("Successfully added member to team.")))},error:()=>{this.setState({loading:!1}),(0,m.Iw)((0,w.t)("Unable to add team member."))}})})),(0,r.Z)(this,"removeTeamMember",(e=>{const{organization:t,params:s}=this.props,{teamMembers:r}=this.state;(0,d.s)(this.props.api,{orgId:t.slug,teamId:s.teamId,memberId:e.id},{success:()=>{this.setState({teamMembers:r.filter((t=>t.id!==e.id))}),(0,m.S9)((0,w.t)("Successfully removed member from team."))},error:()=>(0,m.Iw)((0,w.t)("There was an error while trying to remove a member from the team."))})})),(0,r.Z)(this,"updateTeamMemberRole",((e,t)=>{const{organization:s}=this.props,{teamId:r}=this.props.params,a=`/organizations/${s.slug}/members/${e.id}/teams/${r}/`;this.props.api.request(a,{method:"PUT",data:{teamRole:t},success:t=>{const s=[...this.state.teamMembers],r=s.findIndex((t=>t.id===e.id));s[r]={...e,teamRole:t.teamRole},this.setState({teamMembers:s}),(0,m.S9)((0,w.t)("Successfully changed role for team member."))},error:()=>{(0,m.Iw)((0,w.t)("There was an error while trying to change the roles for a team member."))}})})),(0,r.Z)(this,"handleMemberFilterChange",(e=>{this.setState({dropdownBusy:!0}),this.debouncedFetchMembersRequest(e.target.value)}))}getDefaultState(){return{...super.getDefaultState(),loading:!0,error:!1,dropdownBusy:!1,teamMembers:[],orgMembers:[]}}componentDidMount(){this.fetchMembersRequest("")}getEndpoints(){const{organization:e,params:t}=this.props;return[["teamMembers",`/teams/${e.slug}/${t.teamId}/members/`,{},{paginate:!0}]]}renderDropdown(e,t){const{organization:s,params:r,team:a}=this.props,{orgMembers:o}=this.state,i=new Set(this.state.teamMembers.map((e=>e.id))),n=!!s?.openMembership||e,m=a.flags["idp:provisioned"]||null!==a.orgRole&&!t,d=(o||[]).filter((e=>!i.has(e.id))).map((e=>({searchKey:`${e.name} ${e.email}`,value:e.id,label:(0,_.BX)($,{children:[(0,_.tZ)(X,{user:e,size:24,className:"avatar"}),(0,_.tZ)(P,{children:e.name||e.email})]})}))),p=(0,_.BX)(E,{children:[(0,w.t)("Members"),(0,_.tZ)(V,{to:"",onClick:()=>(0,l.openInviteMembersModal)({source:"teams"}),"data-test-id":"invite-member",children:(0,w.t)("Invite Member")})]});return(0,_.tZ)(c.Z,{items:d,alignMenu:"right",onSelect:n?this.addTeamMember:e=>(0,l.openTeamAccessRequestModal)({teamId:r.teamId,orgId:s.slug,memberId:e.value}),menuHeader:p,emptyMessage:(0,w.t)("No members"),onChange:this.handleMemberFilterChange,busy:this.state.dropdownBusy,onClose:()=>this.debouncedFetchMembersRequest(""),disabled:m,children:e=>{let{isOpen:t}=e;return(0,_.tZ)(u.Z,{isOpen:t,size:"xs","data-test-id":"add-member",disabled:m,children:(0,w.t)("Add Member")})}})}render(){if(this.state.loading)return(0,_.tZ)(x.Z,{});if(this.state.error)return(0,_.tZ)(b.Z,{onRetry:this.fetchData});const{organization:e,config:t,team:s}=this.props,{teamMembersPageLinks:r}=this.state,{access:a}=e,i=a.includes("org:write")||a.includes("team:admin"),n=a.includes("org:admin");return(0,_.BX)(o.Fragment,{children:[(0,_.BX)(f.s_,{children:[(0,_.BX)(f.V9,{hasButtons:!0,children:[(0,_.tZ)("div",{children:(0,w.t)("Members")}),(0,_.tZ)("div",{style:{textTransform:"none"},children:this.renderDropdown(i,n)})]}),this.state.teamMembers.length?this.state.teamMembers.map((r=>(0,_.tZ)(U,{hasWriteAccess:i,isOrgOwner:n,team:s,member:r,organization:e,removeMember:this.removeTeamMember,updateMemberRole:this.updateTeamMemberRole,user:t.user},r.id))):(0,_.tZ)(g.Z,{icon:(0,_.tZ)(v.qO,{size:"xl"}),size:"large",children:(0,w.t)("This team has no members")})]}),(0,_.tZ)(Z.Z,{pageLinks:r})]})}}W.displayName="TeamMembers";const $=(0,a.Z)("div",{target:"e1anr5pt4"})("display:grid;grid-template-columns:max-content 1fr;gap:",(0,R.D)(.5),";align-items:center;"),P=(0,a.Z)("div",{target:"e1anr5pt3"})("font-size:",(e=>e.theme.fontSizeSmall),";",(e=>e.theme.overflowEllipsis),";"),X=(0,a.Z)((e=>(0,_.tZ)(p.Z,{...e})),{target:"e1anr5pt2"})({name:"1dy9mco",styles:"min-width:1.75em;min-height:1.75em;width:1.5em;height:1.5em"}),E=(0,a.Z)("div",{target:"e1anr5pt1"})("display:grid;grid-template-columns:1fr max-content;padding:",(0,R.D)(1)," 0;font-size:",(e=>e.theme.fontSizeExtraSmall),";text-transform:uppercase;"),V=(0,a.Z)(h.Z,{target:"e1anr5pt0"})({name:"kxbue8",styles:"text-transform:none"}),J=(0,M.Z)((0,y.Z)((0,z.Z)(W)))},"./app/views/settings/organizationTeams/utils.tsx":(e,t,s)=>{s.d(t,{m:()=>a});var r=s("./app/locale.tsx");function a(e,t){return e?(0,r.t)("Membership to this team is managed through your organization's identity provider."):t?(0,r.t)("Membership to a team with an organization role is managed by org owners."):void 0}}}]);
//# sourceMappingURL=../sourcemaps/app_views_settings_organizationTeams_teamMembers_tsx.4e4b94d6aa7fa7c0e377acd9d8df0dba.js.map