(globalThis.webpackChunk=globalThis.webpackChunk||[]).push([["app_views_monitors_components_monitorForm_tsx-node_modules_lodash_groupBy_js"],{"./app/utils/slugify.tsx":(e,t,n)=>{"use strict";function o(e){return e.normalize("NFKD").toLowerCase().replace(" ","-").replace(/[^a-z0-9-_]/g,"")}n.d(t,{Z:()=>o})},"./app/views/monitors/components/monitorForm.tsx":(e,t,n)=>{"use strict";n.d(t,{Z:()=>B});var o=n("../node_modules/@emotion/react/dist/emotion-react.browser.esm.js"),i=n("../node_modules/@emotion/styled/base/dist/emotion-styled-base.browser.esm.js"),s=n("../node_modules/react/index.js"),r=n("../node_modules/mobx-react-lite/es/index.js"),l=n("./app/components/alert.tsx"),a=n("./app/components/forms/fields/numberField.tsx"),c=n("./app/components/forms/fields/radioField.tsx"),d=n("./app/components/forms/fields/selectField.tsx"),u=n("./app/components/forms/fields/sentryProjectSelectorField.tsx"),p=n("./app/components/forms/fields/textField.tsx"),m=n("./app/components/forms/form.tsx"),h=n("./app/components/forms/model.tsx"),f=n("./app/components/links/externalLink.tsx"),g=n("./app/components/list/index.tsx"),y=n("./app/components/list/listItem.tsx"),Z=n("./app/components/text.tsx"),x=n("./app/data/timezones.tsx"),b=n("./app/locale.tsx"),_=n("./app/styles/space.tsx"),v=n("./app/utils/isActiveSuperuser.tsx"),w=n("./app/utils/slugify.tsx"),j=n("./app/utils/theme.tsx"),k=n("./app/utils/usePageFilters.tsx"),S=n("./app/utils/useProjects.tsx"),C=n("./app/views/monitors/utils.tsx"),I=n("./app/views/monitors/types.tsx"),A=n("../node_modules/@emotion/react/jsx-runtime/dist/emotion-react-jsx-runtime.browser.esm.js");const N=[[I.Ix.CRONTAB,(0,b.t)("Crontab")],[I.Ix.INTERVAL,(0,b.t)("Interval")]],E="cron_job",O="0 0 * * *";function R(e,t){return t.fields.toJSON().reduce(((e,t)=>{let[n,o]=t;return n.startsWith("config.")?(e.config??={},"config.schedule.frequency"!==n&&"config.schedule.interval"!==n||Array.isArray(e.config.schedule)||(e.config.schedule=[1,"hour"]),Array.isArray(e.config.schedule)&&"config.schedule.frequency"===n?(e.config.schedule[0]=parseInt(o,10),e):Array.isArray(e.config.schedule)&&"config.schedule.interval"===n?(e.config.schedule[1]=o,e):(e.config[n.substr(7)]=o,e)):(e[n]=o,e)}),{})}function q(e){if(void 0===e.config)return e;const{config:t,...n}=e;return{...n,...Object.fromEntries(Object.entries(t).map((e=>{let[t,n]=e;return[`config.${t}`,n]})))}}function T(e){let{monitor:t,submitLabel:n,apiEndpoint:i,apiMethod:a,onSubmitSuccess:d}=e;const u=(0,s.useRef)(new h.Z({transformData:R,mapFormErrors:q})),{projects:p}=(0,S.Z)(),{selection:g}=(0,k.Z)(),[y,Z]=(0,s.useState)(t?.config.schedule_type===I.Ix.CRONTAB?t?.config.schedule:O),_=g.projects[0],T=_?p.find((e=>e.id===_+"")):null,B=(0,v.M)(),U=p.filter((e=>B||e.isMember)),W=(0,C.Z)(y);return(0,A.tZ)(m.Z,{allowUndo:!0,requireChanges:!0,apiEndpoint:i,apiMethod:a,model:u.current,initialData:t?{name:t.name,slug:t.slug,type:t.type??E,project:t.project.slug,...function(e,t){const n={};return"cron_job"===e&&(n["config.schedule_type"]=t.schedule_type,n["config.checkin_margin"]=t.checkin_margin,n["config.max_runtime"]=t.max_runtime,"interval"===t.schedule_type?(n["config.schedule.frequency"]=t.schedule[0],n["config.schedule.interval"]=t.schedule[1]):(n["config.schedule"]=t.schedule,n["config.timezone"]=t.timezone)),n}(t.type,t.config)}:{project:T?T.slug:null,type:E},onSubmitSuccess:d,submitLabel:n,children:(0,A.BX)(F,{symbol:"colored-numeric",children:[(0,A.tZ)(P,{children:(0,b.t)("Add a name and project")}),(0,A.tZ)(X,{children:(0,b.t)("The monitor name will show up in alerts and notifications")}),(0,A.BX)(K,{children:[(0,A.tZ)(M,{name:"name",placeholder:(0,b.t)("My Cron Job"),required:!0,stacked:!0,inline:!1}),t&&(0,A.tZ)(M,{name:"slug",help:(0,b._N)("The [strong:monitor-slug] is used to uniquely identify your monitor within your organization. Changing this slug will require updates to any instrumented check-in calls.",{strong:(0,A.tZ)("strong",{})}),placeholder:(0,b.t)("monitor-slug"),required:!0,stacked:!0,inline:!1,transformInput:w.Z}),(0,A.tZ)(L,{name:"project",projects:U,placeholder:(0,b.t)("Choose Project"),disabled:!!t,disabledReason:(0,b.t)("Existing monitors cannot be moved between projects"),valueIsSlug:!0,required:!0,stacked:!0,inline:!1})]}),(0,A.tZ)(P,{children:(0,b.t)("Choose your schedule type")}),(0,A.tZ)(X,{children:(0,b._N)("You can use [link:the crontab syntax] or our interval schedule.",{link:(0,A.tZ)(f.Z,{href:"https://en.wikipedia.org/wiki/Cron"})})}),(0,A.tZ)(K,{children:(0,A.tZ)(c.Z,{name:"config.schedule_type",choices:N,defaultValue:I.Ix.CRONTAB,orientInline:!0,required:!0,stacked:!0,inline:!1})}),(0,A.tZ)(P,{children:(0,b.t)("Choose your schedule")}),(0,A.tZ)(X,{children:(0,b.t)("How often you expect your recurring jobs to run.")}),(0,A.BX)(K,{children:[void 0!==t&&(0,A.tZ)(l.ZP,{type:"info",children:(0,b.t)("Any changes you make to the execution schedule will only be applied after the next expected check-in.")}),(0,A.tZ)(r.Qj,{children:()=>{const e=u.current.getValue("config.schedule_type");return"crontab"===e?(0,A.BX)(H,{children:[(0,A.tZ)(M,{name:"config.schedule",placeholder:"* * * * *",defaultValue:O,css:(0,o.iv)({input:{fontFamily:j.ZP.text.familyMono}},"",""),required:!0,stacked:!0,onChange:Z,inline:!1}),(0,A.tZ)(V,{name:"config.timezone",defaultValue:"UTC",options:x.f,required:!0,stacked:!0,inline:!1}),W&&(0,A.BX)(J,{children:['"',W,'"']})]}):"interval"===e?(0,A.BX)(H,{interval:!0,children:[(0,A.tZ)(D,{children:(0,b.t)("Every")}),(0,A.tZ)(z,{name:"config.schedule.frequency",placeholder:"e.g. 1",defaultValue:"1",required:!0,stacked:!0,inline:!1}),(0,A.tZ)(V,{name:"config.schedule.interval",options:(t=Number(u.current.getValue("config.schedule.frequency")??1),[{value:"minute",label:(0,b.tn)("minute","minutes",t)},{value:"hour",label:(0,b.tn)("hour","hours",t)},{value:"day",label:(0,b.tn)("day","days",t)},{value:"week",label:(0,b.tn)("week","weeks",t)},{value:"month",label:(0,b.tn)("month","months",t)},{value:"year",label:(0,b.tn)("year","years",t)}]),defaultValue:"day",required:!0,stacked:!0,inline:!1})]}):null;var t}})]}),(0,A.tZ)(P,{children:(0,b.t)("Set a missed status")}),(0,A.tZ)(X,{children:(0,b.t)("The number of minutes we'll wait before we consider a check-in as missed.")}),(0,A.tZ)(K,{children:(0,A.tZ)(z,{name:"config.checkin_margin",placeholder:"e.g. 30",stacked:!0,inline:!1})}),(0,A.tZ)(P,{children:(0,b.t)("Set a failed status")}),(0,A.tZ)(X,{children:(0,b.t)("The number of minutes a check-in is allowed to run before it's considered failed.")}),(0,A.tZ)(K,{children:(0,A.tZ)(z,{name:"config.max_runtime",placeholder:"e.g. 30",stacked:!0,inline:!1})})]})})}T.displayName="MonitorForm";const B=T,F=(0,i.Z)(g.Z,{target:"epnopid10"})({name:"yrf9ut",styles:"width:600px"}),z=(0,i.Z)(a.Z,{target:"epnopid9"})({name:"1hcx8jb",styles:"padding:0"}),V=(0,i.Z)(d.Z,{target:"epnopid8"})({name:"1hcx8jb",styles:"padding:0"}),M=(0,i.Z)(p.Z,{target:"epnopid7"})({name:"1hcx8jb",styles:"padding:0"}),L=(0,i.Z)(u.Z,{target:"epnopid6"})({name:"1hcx8jb",styles:"padding:0"}),P=(0,i.Z)(y.Z,{target:"epnopid5"})("font-size:",(e=>e.theme.fontSizeExtraLarge),";font-weight:bold;line-height:1.3;"),D=(0,i.Z)(Z.Z,{target:"epnopid4"})("font-weight:bold;color:",(e=>e.theme.subText),";"),X=(0,i.Z)(D,{target:"epnopid3"})("font-weight:normal;padding-left:",(0,_.Z)(4),";"),K=(0,i.Z)("div",{target:"epnopid2"})("padding-left:",(0,_.Z)(4),";margin-top:",(0,_.Z)(1),";margin-bottom:",(0,_.Z)(4),";display:flex;flex-direction:column;gap:",(0,_.Z)(1),";"),H=(0,i.Z)("div",{target:"epnopid1"})("display:grid;align-items:center;gap:",(0,_.Z)(1),";grid-template-columns:",(e=>e.interval&&"auto")," 1fr 2fr;"),J=(0,i.Z)(D,{target:"epnopid0"})("font-weight:normal;font-size:",(e=>e.theme.fontSizeExtraSmall),";font-family:",(e=>e.theme.text.familyMono),";grid-column:auto/span 2;")},"./app/views/monitors/types.tsx":(e,t,n)=>{"use strict";let o,i,s,r;n.d(t,{Ix:()=>i,NI:()=>r,wo:()=>s}),function(e){e.UNKNOWN="unknown",e.CRON_JOB="cron_job"}(o||(o={})),function(e){e.CRONTAB="crontab",e.INTERVAL="interval"}(i||(i={})),function(e){e.OK="ok",e.ERROR="error",e.DISABLED="disabled",e.ACTIVE="active",e.MISSED_CHECKIN="missed_checkin"}(s||(s={})),function(e){e.OK="ok",e.ERROR="error",e.IN_PROGRESS="in_progress",e.MISSED="missed"}(r||(r={}))},"./app/views/monitors/utils.tsx":(e,t,n)=>{"use strict";n.d(t,{Z:()=>r});var o=n("../node_modules/cronstrue/dist/cronstrue.js"),i=n.n(o),s=n("./app/utils/dates.tsx");function r(e){if(!e)return null;let t;try{t=i().toString(e,{verbose:!0,use24HourTimeFormat:(0,s.gn)()})}catch(e){return null}return t}},"../node_modules/lodash/groupBy.js":(e,t,n)=>{var o=n("../node_modules/lodash/_baseAssignValue.js"),i=n("../node_modules/lodash/_createAggregator.js"),s=Object.prototype.hasOwnProperty,r=i((function(e,t,n){s.call(e,n)?e[n].push(t):o(e,n,[t])}));e.exports=r}}]);
//# sourceMappingURL=../sourcemaps/app_views_monitors_components_monitorForm_tsx-node_modules_lodash_groupBy_js.665173ec3ce777ed09bad831094487ca.js.map