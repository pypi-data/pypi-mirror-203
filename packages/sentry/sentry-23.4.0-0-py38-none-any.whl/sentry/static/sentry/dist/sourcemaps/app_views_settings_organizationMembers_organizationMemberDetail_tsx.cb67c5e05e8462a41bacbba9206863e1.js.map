{"version":3,"file":"chunks/app_views_settings_organizationMembers_organizationMemberDetail_tsx.xxxxxxxxxxxxxxxxxxxx.js","mappings":"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","sources":["webpack:///./app/utils/isMemberDisabledFromLimit.tsx","webpack:///./app/views/settings/organizationMembers/inviteMember/orgRoleSelect.tsx","webpack:///./app/views/settings/organizationMembers/organizationMemberDetail.tsx"],"sourcesContent":["import {Member} from 'sentry/types';\n\n// check to see if a member has been disabled because of the member limit\nexport default function isMemberDisabledFromLimit(member?: Member | null) {\n  return member?.flags['member-limit:restricted'] ?? false;\n}\n","import {Component} from 'react';\nimport styled from '@emotion/styled';\n\nimport {\n  Panel,\n  PanelAlert,\n  PanelBody,\n  PanelHeader,\n  PanelItem,\n} from 'sentry/components/panels';\nimport Radio from 'sentry/components/radio';\nimport {t, tct} from 'sentry/locale';\nimport {OrgRole} from 'sentry/types';\nimport TextBlock from 'sentry/views/settings/components/text/textBlock';\n\nconst Label = styled('label')`\n  display: flex;\n  flex: 1;\n  align-items: center;\n  margin-bottom: 0;\n`;\n\ntype Props = {\n  disabled: boolean;\n  enforceAllowed: boolean;\n  enforceIdpRoleRestricted: boolean;\n  enforceRetired: boolean;\n  isCurrentUser: boolean;\n  roleList: OrgRole[];\n  roleSelected: string;\n  setSelected: (id: string) => void;\n};\n\nclass OrganizationRoleSelect extends Component<Props> {\n  render() {\n    const {\n      disabled,\n      enforceRetired,\n      enforceAllowed,\n      isCurrentUser,\n      roleList,\n      enforceIdpRoleRestricted,\n      roleSelected,\n      setSelected,\n    } = this.props;\n\n    return (\n      <Panel>\n        <PanelHeader>\n          <div>{t('Organization Role')}</div>\n        </PanelHeader>\n        {enforceIdpRoleRestricted && (\n          <PanelAlert>\n            {tct(\n              \"[person] organization-level role is managed through your organization's identity provider.\",\n              {person: isCurrentUser ? 'Your' : \"This member's\"}\n            )}\n          </PanelAlert>\n        )}\n\n        <PanelBody>\n          {roleList.map(role => {\n            const {desc, name, id, allowed, isRetired: roleRetired} = role;\n\n            const isRetired = enforceRetired && roleRetired;\n            const isDisabled =\n              disabled ||\n              isRetired ||\n              (enforceAllowed && !allowed) ||\n              enforceIdpRoleRestricted;\n\n            return (\n              <PanelItem\n                key={id}\n                onClick={() => !isDisabled && setSelected(id)}\n                css={!isDisabled ? {} : {color: 'grey', cursor: 'default'}}\n              >\n                <Label>\n                  <Radio id={id} value={name} checked={id === roleSelected} readOnly />\n                  <div style={{flex: 1, padding: '0 16px'}}>\n                    {name}\n                    <TextBlock noMargin>\n                      <div className=\"help-block\">{desc}</div>\n                    </TextBlock>\n                  </div>\n                </Label>\n              </PanelItem>\n            );\n          })}\n        </PanelBody>\n      </Panel>\n    );\n  }\n}\n\nexport default OrganizationRoleSelect;\n","import {Fragment} from 'react';\nimport {RouteComponentProps} from 'react-router';\nimport styled from '@emotion/styled';\nimport * as Sentry from '@sentry/react';\nimport isEqual from 'lodash/isEqual';\n\nimport {removeAuthenticator} from 'sentry/actionCreators/account';\nimport {\n  addErrorMessage,\n  addLoadingMessage,\n  addSuccessMessage,\n} from 'sentry/actionCreators/indicator';\nimport {resendMemberInvite, updateMember} from 'sentry/actionCreators/members';\nimport {Button} from 'sentry/components/button';\nimport ButtonBar from 'sentry/components/buttonBar';\nimport Confirm from 'sentry/components/confirm';\nimport DateTime from 'sentry/components/dateTime';\nimport NotFound from 'sentry/components/errors/notFound';\nimport FieldGroup from 'sentry/components/forms/fieldGroup';\nimport HookOrDefault from 'sentry/components/hookOrDefault';\nimport ExternalLink from 'sentry/components/links/externalLink';\nimport {Panel, PanelBody, PanelHeader, PanelItem} from 'sentry/components/panels';\nimport TextCopyInput from 'sentry/components/textCopyInput';\nimport {Tooltip} from 'sentry/components/tooltip';\nimport {IconRefresh} from 'sentry/icons';\nimport {t, tct} from 'sentry/locale';\nimport configStore from 'sentry/stores/configStore';\nimport {space} from 'sentry/styles/space';\nimport {Member, Organization} from 'sentry/types';\nimport isMemberDisabledFromLimit from 'sentry/utils/isMemberDisabledFromLimit';\nimport Teams from 'sentry/utils/teams';\nimport {normalizeUrl} from 'sentry/utils/withDomainRequired';\nimport withOrganization from 'sentry/utils/withOrganization';\nimport AsyncView from 'sentry/views/asyncView';\nimport SettingsPageHeader from 'sentry/views/settings/components/settingsPageHeader';\nimport TeamSelect from 'sentry/views/settings/components/teamSelect';\n\nimport OrganizationRoleSelect from './inviteMember/orgRoleSelect';\n\nconst MULTIPLE_ORGS = t('Cannot be reset since user is in more than one organization');\nconst NOT_ENROLLED = t('Not enrolled in two-factor authentication');\nconst NO_PERMISSION = t('You do not have permission to perform this action');\nconst TWO_FACTOR_REQUIRED = t(\n  'Cannot be reset since two-factor is required for this organization'\n);\n\ntype RouteParams = {\n  memberId: string;\n};\n\ntype Props = {\n  organization: Organization;\n} & RouteComponentProps<RouteParams, {}>;\n\ntype State = {\n  member: Member | null;\n  orgRole: Member['orgRole'];\n  teamRoles: Member['teamRoles'];\n} & AsyncView['state'];\n\nconst DisabledMemberTooltip = HookOrDefault({\n  hookName: 'component:disabled-member-tooltip',\n  defaultComponent: ({children}) => <Fragment>{children}</Fragment>,\n});\n\nclass OrganizationMemberDetail extends AsyncView<Props, State> {\n  get hasTeamRoles() {\n    const {organization} = this.props;\n    return organization.features.includes('team-roles');\n  }\n\n  getDefaultState(): State {\n    return {\n      ...super.getDefaultState(),\n      member: null,\n      orgRole: '',\n      teamRoles: [],\n    };\n  }\n\n  getEndpoints(): ReturnType<AsyncView['getEndpoints']> {\n    const {organization, params} = this.props;\n    return [\n      ['member', `/organizations/${organization.slug}/members/${params.memberId}/`],\n    ];\n  }\n\n  onRequestSuccess({data, stateKey}: {data: Member; stateKey: string}) {\n    if (stateKey === 'member') {\n      const {orgRole, teamRoles} = data;\n      this.setState({orgRole, teamRoles});\n    }\n  }\n\n  handleSave = async () => {\n    const {organization, params} = this.props;\n    const {orgRole, teamRoles} = this.state;\n\n    addLoadingMessage(t('Saving...'));\n    this.setState({busy: true});\n\n    try {\n      const updatedMember = await updateMember(this.api, {\n        orgId: organization.slug,\n        memberId: params.memberId,\n        data: {orgRole, teamRoles} as any,\n      });\n      this.setState({member: updatedMember, busy: false});\n      addSuccessMessage(t('Saved'));\n    } catch (resp) {\n      const errorMessage =\n        (resp && resp.responseJSON && resp.responseJSON.detail) || t('Could not save...');\n      this.setState({busy: false});\n      addErrorMessage(errorMessage);\n    }\n  };\n\n  handleInvite = async (regenerate: boolean) => {\n    const {organization, params} = this.props;\n\n    addLoadingMessage(t('Sending invite...'));\n\n    this.setState({busy: true});\n\n    try {\n      const data = await resendMemberInvite(this.api, {\n        orgId: organization.slug,\n        memberId: params.memberId,\n        regenerate,\n      });\n\n      addSuccessMessage(t('Sent invite!'));\n\n      if (regenerate) {\n        this.setState(state => ({member: {...state.member, ...data}}));\n      }\n    } catch (_err) {\n      addErrorMessage(t('Could not send invite'));\n    }\n\n    this.setState({busy: false});\n  };\n\n  handle2faReset = async () => {\n    const {organization, router} = this.props;\n    const {user} = this.state.member!;\n\n    const requests = user.authenticators.map(auth =>\n      removeAuthenticator(this.api, user.id, auth.id)\n    );\n\n    try {\n      await Promise.all(requests);\n      router.push(normalizeUrl(`/settings/${organization.slug}/members/`));\n      addSuccessMessage(t('All authenticators have been removed'));\n    } catch (err) {\n      addErrorMessage(t('Error removing authenticators'));\n      Sentry.captureException(err);\n    }\n  };\n\n  onAddTeam = (teamSlug: string) => {\n    const teamRoles = [...this.state.teamRoles];\n    const i = teamRoles.findIndex(r => r.teamSlug === teamSlug);\n    if (i !== -1) {\n      return;\n    }\n\n    teamRoles.push({teamSlug, role: null});\n    this.setState({teamRoles});\n  };\n\n  onRemoveTeam = (teamSlug: string) => {\n    const teamRoles = this.state.teamRoles.filter(r => r.teamSlug !== teamSlug);\n    this.setState({teamRoles});\n  };\n\n  onChangeOrgRole = orgRole => this.setState({orgRole});\n\n  onChangeTeamRole = (teamSlug: string, role: string) => {\n    if (!this.hasTeamRoles) {\n      return;\n    }\n\n    const teamRoles = [...this.state.teamRoles];\n    const i = teamRoles.findIndex(r => r.teamSlug === teamSlug);\n    if (i === -1) {\n      return;\n    }\n\n    teamRoles[i] = {...teamRoles[i], role};\n    this.setState({teamRoles});\n  };\n\n  showResetButton = () => {\n    const {organization} = this.props;\n    const {member} = this.state;\n    const {user} = member!;\n\n    if (!user || !user.authenticators || organization.require2FA) {\n      return false;\n    }\n    const hasAuth = user.authenticators.length >= 1;\n    return hasAuth && user.canReset2fa;\n  };\n\n  getTooltip = (): string => {\n    const {organization} = this.props;\n    const {member} = this.state;\n    const {user} = member!;\n\n    if (!user) {\n      return '';\n    }\n\n    if (!user.authenticators) {\n      return NO_PERMISSION;\n    }\n    if (!user.authenticators.length) {\n      return NOT_ENROLLED;\n    }\n    if (!user.canReset2fa) {\n      return MULTIPLE_ORGS;\n    }\n    if (organization.require2FA) {\n      return TWO_FACTOR_REQUIRED;\n    }\n\n    return '';\n  };\n\n  get memberDeactivated() {\n    return isMemberDisabledFromLimit(this.state.member);\n  }\n\n  get hasFormChanged() {\n    const {member, orgRole, teamRoles} = this.state;\n    if (!member) {\n      return false;\n    }\n\n    if (orgRole !== member.orgRole || !isEqual(teamRoles, member?.teamRoles)) {\n      return true;\n    }\n\n    return false;\n  }\n\n  renderMemberStatus(member: Member) {\n    if (this.memberDeactivated) {\n      return (\n        <em>\n          <DisabledMemberTooltip>{t('Deactivated')}</DisabledMemberTooltip>\n        </em>\n      );\n    }\n    if (member.expired) {\n      return <em>{t('Invitation Expired')}</em>;\n    }\n    if (member.pending) {\n      return <em>{t('Invitation Pending')}</em>;\n    }\n    return t('Active');\n  }\n\n  renderBody() {\n    const {organization} = this.props;\n    const {member, orgRole, teamRoles} = this.state;\n\n    if (!member) {\n      return <NotFound />;\n    }\n\n    const {access, features, orgRoleList} = organization;\n    const canEdit = access.includes('org:write') && !this.memberDeactivated;\n    // org:admin is a unique scope that only org owners have\n    const isOrgOwner = access.includes('org:admin');\n    const hasTeamRoles = features.includes('team-roles');\n\n    const {email, expired, pending, invite_link: inviteLink} = member;\n    const canResend = !expired;\n    const showAuth = !pending;\n    const currentUser = configStore.get('user');\n    const isCurrentUser = currentUser.email === email;\n\n    return (\n      <Fragment>\n        <SettingsPageHeader\n          title={\n            <Fragment>\n              <div>{member.name}</div>\n              <ExtraHeaderText>{t('Member Settings')}</ExtraHeaderText>\n            </Fragment>\n          }\n        />\n\n        <Panel>\n          <PanelHeader>{t('Basics')}</PanelHeader>\n\n          <PanelBody>\n            <PanelItem>\n              <Details>\n                <div>\n                  <DetailLabel>{t('Email')}</DetailLabel>\n                  <div>\n                    <ExternalLink href={`mailto:${email}`}>{email}</ExternalLink>\n                  </div>\n                </div>\n                <div>\n                  <DetailLabel>{t('Status')}</DetailLabel>\n                  <div data-test-id=\"member-status\">\n                    {this.renderMemberStatus(member)}\n                  </div>\n                </div>\n                <div>\n                  <DetailLabel>{t('Added')}</DetailLabel>\n                  <div>\n                    <DateTime dateOnly date={member.dateCreated} />\n                  </div>\n                </div>\n              </Details>\n            </PanelItem>\n            <PanelItem>\n              {inviteLink && (\n                <InviteSection>\n                  <InviteField>\n                    <DetailLabel>{t('Invite Link')}</DetailLabel>\n                    <TextCopyInput>{inviteLink}</TextCopyInput>\n                    <p className=\"help-block\">\n                      {t(\n                        'This invite link can be used by anyone who knows it. Keep it secure!'\n                      )}\n                    </p>\n                  </InviteField>\n                  <ButtonBar gap={1}>\n                    {canResend && (\n                      <Button\n                        data-test-id=\"resend-invite\"\n                        onClick={() => this.handleInvite(false)}\n                      >\n                        {t('Resend Invite')}\n                      </Button>\n                    )}\n                    <Button\n                      onClick={() => this.handleInvite(true)}\n                      title={t(\n                        'Generate New Invite. This will invalidate the previous invite link!'\n                      )}\n                      priority=\"danger\"\n                      aria-label={t('Generate New Invite')}\n                      icon={<IconRefresh size=\"sm\" />}\n                    />\n                  </ButtonBar>\n                </InviteSection>\n              )}\n            </PanelItem>\n          </PanelBody>\n        </Panel>\n\n        {showAuth && (\n          <Panel>\n            <PanelHeader>{t('Authentication')}</PanelHeader>\n            <PanelBody>\n              <FieldGroup\n                alignRight\n                flexibleControlStateSize\n                label={t('Reset two-factor authentication')}\n                help={t(\n                  'Resetting two-factor authentication will remove all two-factor authentication methods for this member.'\n                )}\n              >\n                <Tooltip disabled={this.showResetButton()} title={this.getTooltip()}>\n                  <Confirm\n                    disabled={!this.showResetButton()}\n                    message={tct(\n                      'Are you sure you want to disable all two-factor authentication methods for [name]?',\n                      {name: member.name ? member.name : 'this member'}\n                    )}\n                    onConfirm={this.handle2faReset}\n                  >\n                    <Button priority=\"danger\">\n                      {t('Reset two-factor authentication')}\n                    </Button>\n                  </Confirm>\n                </Tooltip>\n              </FieldGroup>\n            </PanelBody>\n          </Panel>\n        )}\n\n        <OrganizationRoleSelect\n          enforceAllowed={false}\n          enforceIdpRoleRestricted={member.flags['idp:role-restricted']}\n          enforceRetired={hasTeamRoles}\n          isCurrentUser={isCurrentUser}\n          disabled={!canEdit}\n          roleList={orgRoleList}\n          roleSelected={orgRole}\n          setSelected={this.onChangeOrgRole}\n        />\n\n        <Teams slugs={member.teams}>\n          {({initiallyLoaded}) => (\n            <TeamSelect\n              enforceIdpProvisioned\n              disabled={!canEdit}\n              isOrgOwner={isOrgOwner}\n              organization={organization}\n              selectedOrgRole={orgRole}\n              selectedTeamRoles={teamRoles}\n              onChangeTeamRole={this.onChangeTeamRole}\n              onAddTeam={this.onAddTeam}\n              onRemoveTeam={this.onRemoveTeam}\n              loadingTeams={!initiallyLoaded}\n            />\n          )}\n        </Teams>\n\n        <Footer>\n          <Button\n            priority=\"primary\"\n            busy={this.state.busy}\n            onClick={this.handleSave}\n            disabled={!canEdit || !this.hasFormChanged}\n          >\n            {t('Save Member')}\n          </Button>\n        </Footer>\n      </Fragment>\n    );\n  }\n}\n\nexport default withOrganization(OrganizationMemberDetail);\n\nconst ExtraHeaderText = styled('div')`\n  color: ${p => p.theme.gray300};\n  font-weight: normal;\n  font-size: ${p => p.theme.fontSizeLarge};\n`;\n\nconst Details = styled('div')`\n  display: grid;\n  grid-auto-flow: column;\n  grid-template-columns: 2fr 1fr 1fr;\n  gap: ${space(2)};\n  width: 100%;\n\n  @media (max-width: ${p => p.theme.breakpoints.small}) {\n    grid-auto-flow: row;\n    grid-template-columns: auto;\n  }\n`;\n\nconst DetailLabel = styled('div')`\n  font-weight: bold;\n  margin-bottom: ${space(0.5)};\n  color: ${p => p.theme.textColor};\n`;\n\nconst InviteField = styled('div')`\n  flex-grow: 1;\n`;\n\nconst InviteSection = styled('div')`\n  flex-grow: 1;\n  display: flex;\n  gap: ${space(1)};\n`;\n\nconst Footer = styled('div')`\n  display: flex;\n  justify-content: flex-end;\n`;\n"],"names":["isMemberDisabledFromLimit","member","flags","Label","_styled","target","name","styles","OrganizationRoleSelect","Component","render","disabled","enforceRetired","enforceAllowed","isCurrentUser","roleList","enforceIdpRoleRestricted","roleSelected","setSelected","this","props","_jsxs","Panel","children","_jsx","PanelHeader","t","PanelAlert","tct","person","PanelBody","map","role","desc","id","allowed","isRetired","roleRetired","isDisabled","PanelItem","onClick","css","color","cursor","Radio","value","checked","readOnly","style","flex","padding","TextBlock","noMargin","className","displayName","MULTIPLE_ORGS","NOT_ENROLLED","NO_PERMISSION","TWO_FACTOR_REQUIRED","DisabledMemberTooltip","HookOrDefault","hookName","defaultComponent","_ref","Fragment","OrganizationMemberDetail","AsyncView","constructor","arguments","_defineProperty","async","organization","params","orgRole","teamRoles","state","addLoadingMessage","setState","busy","updatedMember","updateMember","api","orgId","slug","memberId","data","addSuccessMessage","resp","errorMessage","responseJSON","detail","addErrorMessage","resendMemberInvite","regenerate","_err","router","user","requests","authenticators","auth","removeAuthenticator","Promise","all","push","normalizeUrl","err","Sentry","teamSlug","findIndex","r","filter","hasTeamRoles","i","require2FA","length","canReset2fa","features","includes","getDefaultState","super","getEndpoints","onRequestSuccess","_ref2","stateKey","memberDeactivated","hasFormChanged","isEqual","renderMemberStatus","expired","pending","renderBody","NotFound","access","orgRoleList","canEdit","isOrgOwner","email","invite_link","inviteLink","canResend","showAuth","configStore","SettingsPageHeader","title","ExtraHeaderText","Details","DetailLabel","ExternalLink","href","DateTime","dateOnly","date","dateCreated","InviteSection","InviteField","TextCopyInput","ButtonBar","gap","Button","handleInvite","priority","icon","IconRefresh","size","FieldGroup","alignRight","flexibleControlStateSize","label","help","Tooltip","showResetButton","getTooltip","Confirm","message","onConfirm","handle2faReset","onChangeOrgRole","Teams","slugs","teams","_ref3","initiallyLoaded","TeamSelect","enforceIdpProvisioned","selectedOrgRole","selectedTeamRoles","onChangeTeamRole","onAddTeam","onRemoveTeam","loadingTeams","Footer","handleSave","withOrganization","p","theme","gray300","fontSizeLarge","space","breakpoints","small","textColor"],"sourceRoot":""}